<view class="single-page">
  <!-- modal start -->
  <view class="cu-modal {{modalName=='Modal'?'show':''}}" bindtap="hideModal">
    <view class="cu-dialog" catchtap>
      <view class="list">
        <view class="title l-text">
          {{lessonDetail.name}}
        </view>
        <view class="infos n-text">
          <view class="line">
            <view>æ•™å®¤:</view>
            <view>{{lessonDetail.room}}</view>
          </view>
          <view class="line">
            <view>æ•™å¸ˆ:</view>
            <view>{{lessonDetail.teacher}}</view>
          </view>
          <view class="line">
            <view>ä¸Šè¯¾æ—¶é—´:</view>
            <view>{{lessonDetail.time}}</view>
          </view>
          <view class="line">
            <view>è¯¾æ—¶:</view>
            <view>{{lessonDetail.step}}</view>
          </view>
        </view>
      </view>
    </view>
  </view>
  <!-- modal end -->
  <view class="page-wrapper">
    <!-- å¯¼èˆª -->
    <view class="nav" style="height:{{navHeight}}px;">
      <view class="title" style="top:{{navTop}}px; padding-left:50rpx;">
        <!-- fenxi -->
        <view class="stat context" bindtap="toCharts">
          <text class="iconfont icon-shujufenxi-"></text>
        </view>
        <!-- fenxi -->
        <view class="context" bindtap="togglePre">
          ç¬¬
          <text>{{currentWeek}}</text> å‘¨
        </view>
        <view class="context ll-text" bindtap="togglePre">
          {{ is_pre ? 'ğŸ”¼': 'ğŸ”½' }}
          <!-- <text class="s-text" style="line-height:30rpx; color:#fff;">é€‰æ‹©å½“å‰å‘¨</text> -->
        </view>
      </view>
    </view>

    <!-- è¾¹ç•Œ -->
    <view class="lesson-pre-view" style="display:{{is_pre?'block;':'none;'}}">
      <!-- å±•å¼€ -->
      <scroll-view class="inner-wrap" scroll-x="true">
        <view class="pre-week " wx:for="{{timetable}}" bindtap="changeWeekTable" data-id="{{item.id}}">
          <view class="ss-text week-text">ç¬¬{{item.id}}å‘¨</view>
          <!-- æŒ‰äº”å¤©æ˜¾ç¤º -->
          <view class="les-wrap">
            <view wx:for="{{item.lessons}}" class="pre-lesson-item" style="top:calc({{lessonBlockMarginTop+'*'+(item.start -1)}});left:calc({{lessonBlockMarginLeft+'*'+'7/5'+ '*' +(item.day -1)}});background:{{item.color}};"></view>
          </view>
        </view>
      </scroll-view>
    </view>
    <view class="container">

      <!-- æ¨ªåˆ—:å‘¨ -->
      <view class="week-wrap">
        <view class="row-weeks">
          <view class="week s-text txt-center" wx:for="{{weeks}}" wx:key="id">{{item.zh}}</view>
        </view>
        <view class="row-weeks">
          <view class="week s-text txt-center" wx:for="{{weeks}}" wx:key="id">{{item.en}}</view>
        </view>
      </view>
      <!-- è¯¾ç¨‹è¡¨æ ¼ -->
      <view class="lessons-wrap">
        <view wx:for="{{10}}" wx:key="id" class="lesson-row"></view>
        <!-- å—:è¯¾ç¨‹ -->
        <view class="s-text lesson" wx:for="{{timetable[currentWeek].lessons}}" wx:key="id" style="top:calc({{lessonBlockMarginTop+'*'+(item.start -1)}});left:calc({{lessonBlockMarginLeft+'*' +(item.day -1)}});background:{{item.color}};height:calc({{lessonBlockHeight+ '*' + item.step}});"
          data-lesson="{{item}}" bindtap="showModal">
          <view>{{item.name}}</view>
          <view>{{item.room}}</view>
        </view>
      </view>
      <!-- å·¦ä¾§:èŠ‚æ¬¡ -->
      <view class="schedule">
        <view wx:for="{{schedules}}" wx:key="id" class="s-text schedule-item">
          <view class="item id">{{item.id}}</view>
          <view>{{item.begin}}</view>
          <view>{{item.end}}</view>
        </view>
      </view>
    </view>
  </view>

  <view class="back-modal" wx:if="{{showSetModal}}">
  </view>
  <view class="{{showSetModal? 'set-modal' : 'set-wrap'}}">

      <view wx:if="{{!showSetModal}}">
        <image class="set-icon" bindtap="showSetModal" src="/icon/ç½—ç›˜.png"></image>
      </view>
      <view wx:if="{{!showSetModal}}">
        <image class="set-icon" src="/icon/è®¾ç½®.png"></image>
      </view>

    <form wx:if="{{showSetModal}}" style="{{showSetModal ? 'opacity:1':'opacity:0'}}">
      <view class="txt-center n-text">å¯¼å…¥è¯¾è¡¨</view>
      <view class="cu-form-group n-text form-item">
        <picker bindchange="changeYear" range="{{yearPicker}}">
          é€‰æ‹©å­¦å¹´ï¼š {{selectYear}}
        </picker>
      </view>
      <view class="cu-form-group n-text form-item">
        <picker bindchange="changeTerm" range="{{termPicker}}">é€‰æ‹©å­¦æœŸ: {{selectTerm}}</picker>
      </view>
      <view class="cu-form-group flex">
        <button class="cu-btn l-text" bindtap="selectTable">ç¡®è®¤</button>
        <button class="cu-btn l-text" bindtap="cancelModal">å–æ¶ˆ</button>
      </view>
    </form>
  </view>
</view>